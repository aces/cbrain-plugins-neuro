
<%-
#
# CBRAIN Project
#
# Copyright (C) 2008-2012
# The Royal Institution for the Advancement of Learning
# McGill University
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#
-%>

<% file_args = params[:file_args].presence || {} %>
<% if file_args.size > 1 %>
  <%= render :partial => task_partial(:deprecated_warning) %>
<% end %>

<P>
<STRONG>Input(s):</STRONG>
<P>

<% if params[:collection_id].present? %>
File collection: <%= link_to_userfile_if_accessible params[:collection_id] %>
<% end  %>

<P>

<% if file_args.present? %>
  <ul>
  <% file_args.keys.sort { |a,b| a.to_i <=> b.to_i }.each do |arg_idx| %>
    <% files = file_args[arg_idx] || {} %>

    <% if params[:collection_id].blank? %>
      <li>T1: <%= link_to_userfile_if_accessible files[:t1_id] %></li>    
    <% else %>
      <li>T1: <%= files[:t1_name] %> (inside collection)</li>
    <% end %>

    <% 
      dictionary = { mk: "Mask", mp: "MP2" }
      files.each do |f|
        params_name = f[0]
        next if params_name =~ /^t1_/
        if params_name =~ /^(.*)_id/
    %>
        <li>
          <%= (dictionary[$1.to_sym] || $1.upcase) + " file: " %> <%= link_to_userfile_if_accessible files[params_name] %>
        </li>
      <% end %> 
    <% end %> 
    
    <br/>
    
    <li><%= "Use multispectral: #{ files[:multispectral] == "1" ? "yes" : "no" }" %></li>
    <li><%= "Use spectral mask: #{ files[:spectral_mask] == "1" ? "yes" : "no" }" %></li>
  <% end %>
  </ul>
<% end %>

<P>
<STRONG>Output:</STRONG>
<P>

<% if params[:output_civetcollection_ids].blank? && params[:output_civetcollection_id].present? %>
  CIVET Output: <%= link_to_userfile_if_accessible params[:output_civetcollection_id] %>
<% else %>
  <% ids = params[:output_civetcollection_ids] || [] %>
  <% if ids.present? %>
    <ul>
    <% ids.each do |id| %>
      <li>CIVET Output: <%= link_to_userfile_if_accessible(id) %></li>
    <% end %>
    </ul>
  <% else %>
    No CIVET output generated yet.
  <% end %>
<% end %>

<% if file_args.size == 1 %>

<P>
<STRONG>Other parameters:</STRONG>
<P>

See this task's <%= link_to "edit page", edit_task_path(task) %> for more information.

<% end %>

