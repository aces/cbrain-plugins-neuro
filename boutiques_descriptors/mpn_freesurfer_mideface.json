{
    "name": "MPn_FreeSurfer_MiDeFace",
    "description": "Performs FreeSurfer defacing and refacing for MPN data",
    "tool-version": "7.4.1",
    "url": "https://surfer.nmr.mgh.harvard.edu/fswiki/recon-all",
    "descriptor-url": "https://github.com/aces/cbrain-plugins-neuro/blob/master/boutiques_descriptors/mpn_freesurfer8_MiDeFace.json",
    "author": "Laboratory for Computational Neuroimaging ",
    "schema-version": "0.5",
    "command-line": "export FS_LICENSE=`pwd`/<LICENSE_FILE>; bash /wrapper/mpn_wrap_defaceV3.sh <-i SUBJECT_ID> <-s SES STRING> <-m MODALITY STRING> <-a ACQ STRING> <BIDS_DATASET> `pwd`/<OUTPUT_DIR STRING>",
    "container-image": {
        "index": "docker://",
        "image": "freesurfer/freesurfer:7.4.1",
        "type": "singularity"
    },
    "inputs": [
        {
            "name": "BIDS Dataset Folder",
            "value-key": "<BIDS_DATASET>",
            "type": "File",
            "id": "bids_dir",
            "description": "The BIDS Dataset to process",
            "optional": false
        },
        {
            "name": "Subject ID",
            "command-line-flag": "-i",
            "description": "The ID of the subject to process, with or without 'sub-'",
            "id": "sub_id",
            "optional": false,
            "type": "String",
            "value-key": "<-i SUBJECT_ID>"
        },
        {
            "name": "Subject session",
            "command-line-flag": "-s",
            "value-key": "<-s SES STRING>",
            "type": "String",
            "id": "ses",
            "description": "The ID of the session, without 'ses-'.",
            "optional": true
        },
        {
            "name": "Modality string array",
            "command-line-flag":"-m",
            "value-key": "<-m MODALITY STRING>",
            "type": "String",
            "id": "modality",
            "list": true,
            "list-separator": ",",
            "optional": false
        },
        {
            "name": "Acquisition string array",
            "command-line-flag":"-a",
            "value-key": "<-a ACQ STRING>",
            "type": "String",
            "id": "acq",
	        "list": true,
	        "list-separator": ",",
            "optional": false
        },
        {
            "name": "License file",
            "type": "File",
            "value-key": "<LICENSE_FILE>",
            "id": "license",
            "description": "Valid license file needed to run FreeSurfer",
            "optional": false
        }
    ],
    "output-files": [
        {
            "name": "Output Anonymized files",
            "id": "mideface_output",
            "value-key": "<OUTPUT_DIR STRING>",
            "description": "Directory output",
            "path-template": "<-i SUBJECT_ID>_Anonymized_<-s SES STRING>",
            "optional": false
       }
    ],
    "tags": {
        "domain": ["neuroimaging"]
    },
    "suggested-resources": {
        "ram": 10,
        "walltime-estimate": 82800,
        "cpu-cores": 1
    },
    "custom": {
        "cbrain:author": "Alexandre Pastor-Bernier <alexandre.pastor@mcgill.ca> and Natacha Beck <nbeck@mcin.ca>",
        "cbrain:plugins-container-bindmount": "/wrapper",
        "cbrain:readonly-input-files": true,
        "cbrain:integrator_modules": {
            "BoutiquesFileTypeVerifier": {
                "license":  ["FreesurferLicense", "TextFile", "SingleFile"]
            },
            "BoutiquesFreesurferLicenseFinder": "license",
            "BoutiquesBidsSingleSubjectMaker": {
                "dataset_input_id":  "bids_dir",
                "subjects_input_id": "sub_id",
                "keep_sub_prefix":   true
            },
            "BoutiquesOutputFileTypeSetter": {
                "mideface_output": "MpnFreesurferMidefaceOutput"
            }
        }
    }
}
